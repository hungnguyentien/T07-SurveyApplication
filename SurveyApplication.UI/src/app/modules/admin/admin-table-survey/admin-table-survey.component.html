<p-toast [style]="{ width: '20vw', height: '5vh' }"></p-toast>
<p-confirmDialog #cd [style]="{width: '30vw'}">
    <ng-template pTemplate="header">
        <h5>Xác nhận xoá loại hình đơn vị</h5>
    </ng-template>
    <ng-template pTemplate="footer">
        <button type="button" pButton icon="pi pi-times" class="custom-small-button" label="No"
            (click)="cd.reject()"></button>
        <button type="button" pButton icon="pi pi-check" class="custom-small-button" label="Yes"
            (click)="cd.accept()"></button>
    </ng-template>
</p-confirmDialog>

<div>
    <h5>Danh sách bảng khảo sát</h5>
    <div class="d-flex mt-3">
        <div>
            <!-- <p-button (click)="Add()" icon="pi pi-plus" label="Thêm mới"></p-button> -->

            <button (click)="Add()" data-toggle="modal" data-target="#createForm" pButton type="button"
                icon="pi pi-plus" label="Thêm mới" class="custom-button"></button>
        </div>
        <div class="ml-3">
            <!-- <p-button icon="pi pi-trash" label="Xóa"styleClass="p-button-danger"></p-button> -->
            <button pButton type="button" icon="pi pi-trash" label="Xoá" class="custom-button"
                style="background-color: #ea5c5c;"></button>
        </div>
    </div>
    <form class="form-inline mt-4" (change)="GetTableSurvey()">
        <div class="form-group mb-2">
            <label for="inputPassword2" class="sr-only">Search</label>
            <input type="text" class="form-control" id="inputPassword2" placeholder="Nhập từ khoá" [(ngModel)]="keyword"
                name="keyword" (change)="GetTableSurvey()">
        </div>
        <button type="submit" class="btn btn-primary ml-2 mb-2"><i class="pi pi-search"></i></button>
    </form>
</div>
<div class="card mt-3">
    <p-table #dt [value]="datas" [(selection)]="selectedTableSurvey" dataKey="id" styleClass="p-datatable-gridlines"
        [rowHover]="true" [rows]="10" [showCurrentPageReport]="true">
        <ng-template pTemplate="header">
            <tr>
                <th style="width: 4rem">
                    <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                </th>
                <th style="min-width: 0rem">
                    STT
                </th>
                <th style="min-width: 14rem">
                    <div class="flex justify-content-between align-items-center">
                        Mã bảng khảo sát<div type="text" field="country.name" display="menu" class="ml-auto"></div>
                    </div>
                </th>
                <th style="min-width: 16rem">
                    <div class="flex justify-content-between align-items-center">
                        Tên bảng khảo sát<div type="text" field="country.name" display="menu" class="ml-auto"></div>
                    </div>
                </th>
                <th style="min-width: 16rem">
                    <div class="flex justify-content-between align-items-center">
                        Đợt khảo sát<div type="text" field="country.name" display="menu" class="ml-auto"></div>
                    </div>
                </th>
                <th style="min-width: 16rem">
                    <div class="flex justify-content-between align-items-center">
                        Loại hình đơn vị khảo sát<div type="text" field="country.name" display="menu" class="ml-auto">
                        </div>
                    </div>
                </th>
                <th style="min-width: 10rem">
                    <div class="flex justify-content-between align-items-center">
                        Mô tả<div type="text" field="country.name" display="menu" class="ml-auto"></div>
                    </div>
                </th>
                <th style="min-width: 10rem">
                    <div class="flex justify-content-between align-items-center">
                        Thời gian<div type="text" field="country.name" display="menu" class="ml-auto"></div>
                    </div>
                </th>
                <th style="min-width: 10rem">
                    <div class="flex justify-content-between align-items-center">
                        Trạng thái gửi email<div type="text" field="country.name" display="menu" class="ml-auto"></div>
                    </div>
                </th>
                <th style="min-width: 10rem">
                    <div class="flex justify-content-between align-items-center">
                        Trạng thái khảo sát<div type="text" field="country.name" display="menu" class="ml-auto"></div>
                    </div>
                </th>
                <th style="min-width: 10rem">
                    <div>
                        Chức năng
                    </div>
                </th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-rowData let-rowIndex="rowIndex">
            <tr class="p-selectable-row">

                <td>
                    <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
                </td>
                <td>
                    <span class="p-column-title">STT</span>
                    {{ rowIndex + 1}}
                </td>

                <td>
                    <span class="ml-1 vertical-align-middle">{{ rowData.maBangKhaoSat }}</span>
                </td>
                <td>
                    <span class="ml-1 vertical-align-middle">{{ rowData.tenBangKhaoSat }}</span>
                </td>
                <td>
                    <span class="ml-1 vertical-align-middle">{{ rowData.maDotKhaoSat }}</span>
                </td>
                <td>
                    <span class="ml-1 vertical-align-middle">{{ rowData.maLoaiHinh }}</span>
                </td>

                <td>
                    <span class="ml-1 vertical-align-middle">{{ rowData.moTa }}</span>
                </td>
                <td>
                    <span class="ml-1 vertical-align-middle">{{ rowData.ngayBatDau| date:'dd/MM/yyyy' }}-{{
                        rowData.ngayKetThuc| date:'dd/MM/yyyy' }}</span>
                </td>
                <td>
                    <span class="ml-1 vertical-align-middle"></span>
                </td>
                <td>
                    <span class="ml-1 vertical-align-middle">{{ rowData.trangThai }}</span>
                </td>
                <td>
                    <a class="m-3"><span data-toggle="modal" data-target="#createForm" (click)="Edit(rowData)"
                            class="pi pi-pencil" title="Cập nhật" aria-hidden="true"></span></a>

                    <a class="m-3"><span class="pi pi-trash" title="Xoá" (click)="Delete(rowData)" style="color: red;"
                            aria-hidden="true"></span></a>
                    <a class="m-3"><span class="pi pi-caret-right" title="Dừng" style="color: rgb(32, 154, 60);"
                            aria-hidden="true"></span></a>
                    <a class="m-3"><span class="pi pi-eye" title="Xoá" style="color: rgb(25, 150, 222);"
                            aria-hidden="true"></span></a>
                </td>
            </tr>
        </ng-template>
    </p-table>
    <!-- <p-paginator [rows]="pageSize" [totalRecords]="TotalCount" (onPageChange)="onPageChange($event)"></p-paginator> -->
    <div class="card flex justify-content-center">
        <p-paginator (onPageChange)="onPageChange($event)" [first]="first" [rows]="pageSize" [totalRecords]="TotalCount"
            [rowsPerPageOptions]="[5, 10, 50]"></p-paginator>

    </div>
</div>


<p-dialog [header]="showHeader ? 'Thêm' : ''" [(visible)]="showadd" [modal]="true" [responsive]="true"
    [style]="{width: '50%'}">
    <div class="custom-modal-body">
        <!-- Nội dung modal ở đây -->

        <p-fieldset [formGroup]="FormTableSurvey">
            <div class="grid">
                <div class="col-4">
                    <div class="field">
                        <label for="MaDotKhaoSat" class="col-form-label">Mã Bảng: <span style="color: red;">*</span></label>
                        <input type="text" formControlName="MaDotKhaoSat" pInputText placeholder="Nhập mã bảng khảo sát">
                    </div>
                </div>
                <div class="col-7"> 
                    <div class="field">
                        <label for="MaLoaiHinh" class="col-form-label">Loại hình đơn vị khảo sát: <span style="color: red;">*</span></label>
                        <p-dropdown formControlName="MaLoaiHinh" [options]="DSLoaiHinh" optionLabel="tenLoaiHinh" placeholder="Chọn loại hình đơn vị"></p-dropdown>
                    </div>
                </div>
            </div>
            
           
   
    <div class="p-grid p-fluid">
        <div class="p-col-12 p-md-6">
            <label for="TenDotKhaoSat" class="col-form-label">Tên Bảng: <span style="color: red;">*</span></label>
            <input type="text" formControlName="TenDotKhaoSat" pInputText placeholder="Nhập tên bảng khảo sát">
        </div>
        <div class="p-col-12 p-md-6">
            <label for="MaDotKhaoSat" class="col-form-label">Đợt Khảo Sát: <span style="color: red;">*</span></label>
            <p-dropdown formControlName="MaDotKhaoSat" [options]="DSDotKhaoSat" optionLabel="tenDotKhaoSat"
                placeholder="Chọn đợt khảo sát"></p-dropdown>
        </div>
        <div class="p-col-12 p-md-6">
            <label for="TenDotKhaoSat" class="col-form-label">Mô Tả: <span style="color: red;">*</span></label>
            <textarea rows="3" cols="80" pInputTextarea formControlName="text" formControlName="TenDotKhaoSat"
                placeholder="Nhập mô tả đợt khảo sát" class="form-control"></textarea>
        </div>
    </div>

    <div class="grid">
        <div class="col-6">
            <div class="field">
                <label for="NgayBatDau" class="col-form-label">Ngày bắt đầu: <span style="color: red;">*</span></label>
                <p-calendar formControlName="NgayBatDau" placeholder="Ngày Bắt Đầu" [showIcon]="true"></p-calendar>
            </div>
        </div>
        <div class="col-6">
            <div class="field">
                <label for="NgayKetThuc" class="col-form-label">Ngày kết thúc: <span
                        style="color: red;">*</span></label>
                <p-calendar formControlName="NgayKetThuc" placeholder="Ngày Kết Thúc" [showIcon]="true"></p-calendar>
            </div>
        </div>
    </div>



    </p-fieldset>
    </div>
    <!-- <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel" *ngIf="showadd == true">Thêm mới bảng khảo sát</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p-fieldset [formGroup]="FormTableSurvey">
                    <div class="p-grid p-fluid">
                        <div class="p-col-6">
                            <label for="MaDotKhaoSat" class="col-form-label">Mã Bảng: <span
                                    style="color: red;">*</span></label>
                            <input type="text" formControlName="MaDotKhaoSat" pInputText
                                placeholder="Nhập mã bảng khảo sát">
                        </div>
                        <div class="p-col-6">
                            <label for="MaLoaiHinh" class="col-form-label">Loại hình đơn vị khảo sát: <span
                                    style="color: red;">*</span></label>
                            <p-dropdown formControlName="MaLoaiHinh" [options]="DSLoaiHinh" optionLabel="tenLoaiHinh"
                                placeholder="Chọn loại hình đơn vị"></p-dropdown>
                        </div>
                    
                        <div class="p-col-12 p-md-6">
                            <label for="TenDotKhaoSat" class="col-form-label">Tên Bảng: <span
                                    style="color: red;">*</span></label>
                            <input type="text" formControlName="TenDotKhaoSat" pInputText
                                placeholder="Nhập tên bảng khảo sát">
                        </div>
                        <div class="p-col-12 p-md-6">
                            <label for="MaDotKhaoSat" class="col-form-label">Đợt Khảo Sát: <span
                                    style="color: red;">*</span></label>
                            <p-dropdown formControlName="MaDotKhaoSat" [options]="DSDotKhaoSat"
                                optionLabel="tenDotKhaoSat" placeholder="Chọn đợt khảo sát"></p-dropdown>
                        </div>
                        <div class="p-col-12 p-md-6">
                            <label for="TenDotKhaoSat" class="col-form-label">Mô Tả: <span
                                    style="color: red;">*</span></label>
                            <textarea rows="3" cols="80" pInputTextarea formControlName="text"
                                formControlName="TenDotKhaoSat" placeholder="Nhập mô tả đợt khảo sát"
                                class="form-control"></textarea>
                        </div>
                    </div>
                    
                    <div class="p-grid p-fluid ">
                        <div class="p-col-6">
                            <label for="NgayBatDau" class="col-form-label">Ngày bắt đầu: <span style="color: red;">*</span></label>
                            <p-calendar formControlName="NgayBatDau" placeholder="Ngày Bắt Đầu" [showIcon]="true"></p-calendar>
                        </div>
                        <div class="p-col-6">
                            <label for="NgayKetThuc" class="col-form-label">Ngày kết thúc: <span style="color: red;">*</span></label>
                            <p-calendar formControlName="NgayKetThuc" placeholder="Ngày Kết Thúc" [showIcon]="true"></p-calendar>
                        </div>
                    </div>
                    

                </p-fieldset>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="Save()">Lưu</button>
            </div>
        </div>
    </div> -->
    <!-- Nút để đóng modal -->

    <br>
    <div class="button-container">
        <button pButton label="Đóng" (click)="showadd = false" class="custom-button"></button>
        <button pButton (click)="Save()" label="Lưu" class="custom-button"></button>
    </div>

</p-dialog>


<!-- modal -->